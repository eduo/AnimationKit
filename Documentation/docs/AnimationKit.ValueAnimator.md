# AnimationKit.ValueAnimator

This interface allows custom classes to implement simple animations. Anything numeric can be animated using this interface and the [AnimationKit.ValueTask](AnimationKit.ValueTask.md) task.

## Interface Methods

<pre id="method.animationstep"><span style="color: #000000;"><span style="color: #0000FF;">Sub</span> AnimationStep (Identifier <span style="color: #0000FF;">As</span> <span style="color: #0000FF;">Text</span>, Value <span style="color: #0000FF;">As</span> <span style="color: #0000FF;">Double</span>)</span></pre>
This method is fired as often as necessary to run the animation, providing both the identifier and current value.

## Example Class

The following class is a Label subclass which accepts an integer value and animates counting up/down to the new value. A reference to the last task is retained so the animation can be interrupted and changed to a new value.

<pre><span style="color: #000000;"><span style="color: #0000FF;">Class</span> CountingLabel <span style="color: #0000FF;">Inherits</span> Label<br>  <span style="color: #0000FF;">Public</span> <span style="color: #0000FF;">Sub</span> Add (Amount <span style="color: #0000FF;">As</span> <span style="color: #0000FF;">Integer</span>)<br>    Self.Value = Self.Value + Amount<br>  <span style="color: #0000FF;">End</span> <span style="color: #0000FF;">Sub</span><br>  <br>  <span style="color: #0000FF;">Public</span> <span style="color: #0000FF;">Sub</span> AnimationStep (Identifier <span style="color: #0000FF;">As</span> <span style="color: #0000FF;">Text</span>, Value <span style="color: #0000FF;">As</span> <span style="color: #0000FF;">Double</span>)<br>    <span style="color: #800000;">// Part of the AnimationKit.ValueAnimator interface.</span><br>    <br>    <span style="color: #0000FF;">Select</span> <span style="color: #0000FF;">Case</span> Identifier<br>    <span style="color: #0000FF;">Case</span> <span style="color: #6600FE;">&quot;Text&quot;</span><br>      Self.Text = Str(Round(Value), <span style="color: #6600FE;">&quot;-0&quot;</span>)<br>    <span style="color: #0000FF;">End</span> <span style="color: #0000FF;">Select</span><br>  <span style="color: #0000FF;">End</span> <span style="color: #0000FF;">Sub</span><br>  <br>  <span style="color: #0000FF;">Public</span> <span style="color: #0000FF;">Sub</span> Subtract (Amount <span style="color: #0000FF;">As</span> <span style="color: #0000FF;">Integer</span>)<br>    Self.Value = Self.Value - Amount<br>  <span style="color: #0000FF;">End</span> <span style="color: #0000FF;">Sub</span><br>  <br>  <span style="color: #0000FF;">Public</span> <span style="color: #0000FF;">Function</span> Value () <span style="color: #0000FF;">As</span> <span style="color: #0000FF;">Integer</span><br>    <span style="color: #0000FF;">Return</span> Val(Self.Text)<br>  <span style="color: #0000FF;">End</span> <span style="color: #0000FF;">Function</span><br>  <br>  <span style="color: #0000FF;">Public</span> <span style="color: #0000FF;">Sub</span> Value (<span style="color: #0000FF;">Assigns</span> NewValue <span style="color: #0000FF;">As</span> <span style="color: #0000FF;">Integer</span>)<br>    <span style="color: #0000FF;">If</span> Task &lt;&gt; <span style="color: #0000FF;">Nil</span> <span style="color: #0000FF;">And</span> <span style="color: #0000FF;">Not</span> (Task.Completed <span style="color: #0000FF;">Or</span> Task.Cancelled) <span style="color: #0000FF;">Then</span><br>      Task.Cancel<br>      Task = <span style="color: #0000FF;">Nil</span><br>    <span style="color: #0000FF;">End</span> <span style="color: #0000FF;">If</span><br>    <br>    Task = <span style="color: #0000FF;">New</span> AnimationKit.ValueTask(<span style="color: #0000FF;">Self</span>, <span style="color: #6600FE;">&quot;Text&quot;</span>, Self.Value, Value)<br>    Task.DurationInSeconds = <span style="color: #336698;">1</span><br>    Task.Curve = AnimationKit.Curve.CreateEaseOut<br>    Task.Run<br>  <span style="color: #0000FF;">End</span> <span style="color: #0000FF;">Sub</span><br>  <br>  <span style="color: #0000FF;">Private</span> <span style="color: #0000FF;">Property</span> Task <span style="color: #0000FF;">As</span> AnimationKit.ValueTask<br><span style="color: #0000FF;">End</span> <span style="color: #0000FF;">Class</span></span></pre>

## See Also

[AnimationKit.ValueTask](AnimationKit.ValueTask.md)